/*ActiveLayer = function(layer){	var hText = document.getElementById('headerText');	var browse = document.getElementById('LayerBrowse');	var transaction = document.getElementById('LayerTransaction');	var setting = document.getElementById('LayerSettings');	Browse.d.layer.style.display = 'none';	Transaction.d.layer.style.display = 'none';	Buttons.browse.className = '';	Buttons.transaction.className = '';	switch(layer){	case 'browse':		hText.innerHTML = 'Обзор';		Buttons.browse.className = 'active';		Browse.d.layer.style.display = 'block';	break;	case 'transaction':		hText.innerHTML = 'Транзакции';		Buttons.transaction.className = 'active';		Transaction.d.layer.style.display = 'block';		Transaction.fill();	break;	case 'setting':		hText.innerHTML = 'Транзакции';		Buttons.transaction.className = 'active';		Transaction.d.layer.style.display = 'block';		Transaction.fill();	break;	}	DOC.scrollObj.refresh();}Browse = {	d: {		// Всякие переменные "data"	},	fill: function(){		var obj = Browse;		var accs = zenMoney.account.get();		var sort = zenMoney.account.sort;		var lis = '';		obj.d.a.ul.innerHTML = '';		for( var i = 0; i<sort.length; i++ ){			var li = document.createElement('li');			li.innerHTML = '<span class="title">'+safeText(accs[sort[i]].title)+'</span><span class="status">...</span>';			(function(id, el){				zenMoney.account.balance(id, function(sum){					el.innerHTML = costToString( sum ) + ' ' + zenMoney.instrument.get()[accs[id].instrument].symbol;				});			})( sort[i], li.querySelector('.status') )			obj.d.a.ul.appendChild(li);		}		// Последняя синхронизация была 16 января 2010 г. в 23:15		var lastDiff = localStorage['diff'];		if( lastDiff != '0' ){			var outDiff = 'Последняя синхронизация была ';			var d = new Date( parseInt(lastDiff)*1000 );			outDiff += d.toFormat('%j %Fmr %Y г. ') + d.getHours()+':'+d.getMinutes();		}else{			var outDiff = 'Вы еще не синхронизировались!';		}		obj.d.s.info.innerHTML = outDiff;		DOC.scrollObj.refresh();	},	init: function(){		var obj = Browse;		obj.d.layer = document.getElementById('LayerBrowse');		obj.d.accounts = obj.d.layer.querySelector('.accounts');		obj.d.a = {}		obj.d.a.ul = obj.d.accounts.querySelector('ul');		obj.d.sinc = obj.d.layer.querySelector('.sincInfo');		obj.d.s = {}		obj.d.s.info = obj.d.sinc.querySelector('.info');		obj.fill();	}}Transaction = {	d: {		// Всякие переменные "data"	},	fill: function(){		var obj = Transaction;				var content = obj.d.layer;		var cats = {};		var accs = {};		var inst = zenMoney.instrument.get();				var generateLiElement = function(res){			var li = document.createElement('li');			var tpl = '';			tpl += '<div class="transaction">';			tpl += '	<div class="more">›</div>';			tpl += '	<div class="h">';			if( res.type != 0 ){				res.category = (isNaN(parseInt(res.category))?0:res.category);				tpl += '		<div class="t">'+cats[res.type][res.category].title+'</div>';				if( res.type == -1 ){					if( inst[res.instrument] ){						tpl += '		<div class="s">&minus;'+costToString(res.sum)+' '+inst[res.instrument].symbol+'</div>';					}else{						tpl += '		<div class="s">&minus;'+costToString(res.sum)+' ?</div>';					}				}else{					tpl += '		<div class="s">'+costToString(res.sum)+' '+inst[res.instrument].symbol+'</div>';				}			}else{				tpl += '		<div class="t">Перевод: '+accs[res.account].title+' &rarr; '+accs[res.account_transfer].title+'</div>';				if( ( res.sum == res.sum_transfer ) && ( res.instrument == res.instrument_transfer ) ){					tpl += '		<div class="s">'+costToString(res.sum)+' '+inst[res.instrument].symbol+'</div>';				}else{					tpl += '		<div class="s">'+costToString(res.sum)+' '+inst[res.instrument].symbol+' &rarr; '+costToString(res.sum_transfer)+' '+inst[res.instrument_transfer].symbol+'</div>';				}			}						tpl += '	</div>';			tpl += '	<div class="b">';			if( res.payee != '' ){				tpl += '		<div class="p"><strong>Получатель, </strong> '+safeText(res.payee)+'</div>';			}			if( res.comment != '' ){				tpl += '		<div class="c"><strong>Комментарий, </strong> '+safeText(res.comment)+'</div>';			}			tpl += '	</div>';			tpl += '</div>';									var drag = false;			li.addEventListener(EVENTS.touchstart, function(){ drag = false; }, false);			li.addEventListener(EVENTS.touchmove, function(){ drag = true; }, false);			(function(li, res){				li.addEventListener(EVENTS.touchend, function(){					if( !drag ){						zForm.fill(res);						zForm.parent.style.display = 'block';					}else{						drag = false;					}				}, false);			})(li, res)						li.innerHTML = tpl;			return li;		}		var draw_transactions = function(trans){			var frag = document.createDocumentFragment();			var ul = undefined;			var dh, dt = undefined;			content.innerHTML = '';			var last_date = undefined;			for( var i = 0; i<trans.length; i++ ){				if( last_date != trans[i].date ){					last_date = trans[i].date;					dh = document.createElement('h3');					dt = document.createTextNode( new Date(trans[i].date).toFormat('%j %Fmr %Y') );					dh.appendChild(dt);					frag.appendChild(dh);					ul = document.createElement('ul');					frag.appendChild(ul);				}				ul.insertBefore( generateLiElement(trans[i]), ul.firstChild );			}			if( trans.length == 30 ){				var more = document.createElement('li');				more.className = 'more';				more.innerHTML = 'Загружаем еще...';				ul.appendChild( more );			}			content.appendChild(frag);			DOC.scrollObj.refresh();			//obj.d.scroll.refresh();		}				cats = zenMoney.category.get();		accs = zenMoney.account.get();		zenMoney.transaction.get.list({skip:0, limit:30}, draw_transactions);	},	init: function(){		var obj = Transaction;		obj.d.layer = document.getElementById('LayerTransaction');		//obj.d.scroll = new iScroll('LayerTransaction', {desktopCompatibility:true});	}}Settings = {	d: {		// Всякие переменные "data"		init: false	},	fill: function(){		var obj = Settings;		if( !obj.d.init ){			obj.init();		}else{					}	},	init: function(){		var obj = Settings;		obj.d.layer = document.getElementById('LayerSettings');	}}*/